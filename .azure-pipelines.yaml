jobs:
  - job: demo_app
    pool:
      vmImage: ubuntu-latest
    steps:
      - checkout: self
        displayName: checkout self
      - script: |
          echo "y" | sudo /usr/local/lib/android/sdk/tools/bin/sdkmanager --install "ndk;21.0.6113669" --sdk_root=${ANDROID_SDK_ROOT}
        displayName: install ndk
      - task: Gradle@2
        displayName: tasks
        inputs:
          gradleWrapperFile: gradlew
          tasks: :demo:tasks
      - task: Gradle@2
        displayName: assembleWithDecoderExtensions
        inputs:
          gradleWrapperFile: gradlew
          tasks: :demo:assembleWithDecoderExtensions
          options: --info
      - task: CopyFiles@2
        displayName: copy files
        inputs:
          Contents: "**/*.apk"
          TargetFolder: $(Build.ArtifactStagingDirectory)
      - publish: $(Build.ArtifactStagingDirectory)
        artifact: demo_app
        displayName: publish
